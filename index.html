
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineVerse - Your Ultimate Movie Database</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #01b4e4;
            --primary-dark: #0099c3;
            --secondary: #90cea1;
            --secondary-dark: #7bbf8f;
            --dark: #0d253f;
            --darker: #081c30;
            --light: #f8f9fa;
            --gray: #6c757d;
            --danger: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
            --card-bg: #ffffff;
            --body-bg: #f5f7fa;
            --text: #333333;
            --text-light: #6c757d;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.15);
            --radius: 12px;
            --radius-sm: 8px;
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --primary: #0d8abc;
            --primary-dark: #0a6b96;
            --secondary: #7bbf8f;
            --secondary-dark: #68a87a;
            --dark: #1a2d4a;
            --darker: #132238;
            --light: #2d3748;
            --gray: #a0aec0;
            --card-bg: #2d3748;
            --body-bg: #1a202c;
            --text: #e2e8f0;
            --text-light: #a0aec0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--body-bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Header Styles */
        header {
            background-color: var(--dark);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
            text-decoration: none;
        }

        .logo i {
            color: var(--secondary);
        }

        .logo span {
            color: white;
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 1.5rem;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: var(--radius-sm);
        }

        nav ul li a:hover, nav ul li a.active {
            color: var(--primary);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover {
            color: var(--primary);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-dark);
            transform: translateY(-2px);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid white;
            color: white;
        }

        .btn-outline:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(13, 37, 63, 0.85), rgba(13, 37, 63, 0.9)), url('https://source.unsplash.com/random/1200x600/?cinema,movie') no-repeat center center/cover;
            color: white;
            padding: 4rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 2rem;
        }

        .search-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .search-box {
            display: flex;
            margin-top: 1rem;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .search-box input {
            flex: 1;
            padding: 15px;
            border: none;
            font-size: 1rem;
            background-color: white;
            color: var(--text);
        }

        .search-box button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0 25px;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-box button:hover {
            background-color: var(--primary-dark);
        }

        /* Filter Section */
        .filters {
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            transition: var(--transition);
        }

        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            flex: 1;
            min-width: 150px;
        }

        .filter-group label {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .filter-select {
            padding: 10px 12px;
            border-radius: var(--radius);
            border: 1px solid #ddd;
            background-color: var(--card-bg);
            color: var(--text);
            transition: var(--transition);
            cursor: pointer;
        }

        .filter-select:focus {
            border-color: var(--primary);
            outline: none;
        }

        /* Movies Section */
        .section-title {
            margin: 2rem 0 1rem;
            font-size: 1.8rem;
            color: var(--text);
            border-left: 4px solid var(--primary);
            padding-left: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .view-options {
            display: flex;
            gap: 10px;
            background-color: var(--card-bg);
            padding: 5px;
            border-radius: var(--radius);
        }

        .view-option {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .view-option.active, .view-option:hover {
            color: var(--primary);
            background-color: rgba(1, 180, 228, 0.1);
        }

        .movies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 2rem;
        }

        .movies-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 2rem;
        }

        .movie-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }

        .movie-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .movie-poster {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .movie-info {
            padding: 15px;
        }

        .movie-title {
            font-weight: bold;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .movie-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .movie-year {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .movie-rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .rating-stars {
            color: gold;
        }

        .movie-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .action-btn {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px;
            border-radius: var(--radius-sm);
        }

        .action-btn:hover {
            color: var(--primary);
            background-color: rgba(1, 180, 228, 0.1);
        }

        .action-btn.active {
            color: var(--primary);
        }

        .action-btn.watchlist.active {
            color: var(--secondary);
        }

        /* List View */
        .movie-item {
            display: flex;
            background: var(--card-bg);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .movie-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .movie-item-poster {
            width: 100px;
            height: 150px;
            object-fit: cover;
        }

        .movie-item-info {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .movie-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .movie-item-title {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .movie-item-overview {
            margin: 10px 0;
            color: var(--text-light);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .movie-item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 3rem 0 1rem;
            margin-top: auto;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .footer-section {
            flex: 1;
            min-width: 200px;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 8px;
        }

        .footer-section ul li a {
            color: #ddd;
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .footer-section ul li a:hover {
            color: var(--primary);
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 1rem;
        }

        .social-links a {
            color: white;
            font-size: 1.2rem;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .social-links a:hover {
            color: var(--primary);
            background-color: rgba(255, 255, 255, 0.2);
        }

        .copyright {
            text-align: center;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            overflow-y: auto;
            padding: 20px;
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 2% auto;
            width: 90%;
            max-width: 600px;
            border-radius: var(--radius);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
            animation: modalFade 0.3s;
            transition: var(--transition);
        }

        @keyframes modalFade {
            from {opacity: 0; transform: translateY(-50px);}
            to {opacity: 1; transform: translateY(0);}
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            color: var(--text);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: var(--danger);
            background-color: rgba(231, 76, 60, 0.1);
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            background-color: var(--card-bg);
            color: var(--text);
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(1, 180, 228, 0.2);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* Movie Details */
        .movie-details {
            display: flex;
            flex-wrap: wrap;
            background: var(--card-bg);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin: 2rem 0;
            transition: var(--transition);
        }

        .movie-details-poster {
            flex: 0 0 300px;
        }

        .movie-details-poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .movie-details-info {
            flex: 1;
            padding: 2rem;
        }

        .movie-details-title {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .movie-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 1.5rem;
        }

        .movie-meta-item {
            background: var(--light);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            color: var(--dark);
        }

        .movie-overview {
            margin-bottom: 1.5rem;
            line-height: 1.7;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        /* User Profile */
        .profile-header {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            margin-right: 1.5rem;
        }

        .profile-info h1 {
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .profile-info p {
            color: var(--text-light);
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-top: 1rem;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        /* Admin Panel Styles */
        .admin-panel {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin: 2rem 0;
        }

        .admin-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 1.5rem;
        }

        .admin-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-light);
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .admin-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .admin-tab:hover {
            color: var(--primary);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .admin-table th, .admin-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .admin-table th {
            background-color: var(--light);
            color: var(--dark);
            font-weight: 600;
        }

        .admin-table tr:hover {
            background-color: rgba(1, 180, 228, 0.05);
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-published {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .status-draft {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }

        .role-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .role-admin {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        .role-user {
            background-color: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading {
            text-align: center;
            padding: 2rem;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--success);
            color: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            z-index: 3000;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.error {
            background-color: var(--danger);
        }

        .toast.warning {
            background-color: var(--warning);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
            gap: 5px;
        }

        .pagination button {
            background-color: var(--card-bg);
            border: 1px solid #ddd;
            color: var(--text);
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .pagination button:hover {
            background-color: var(--primary);
            color: white;
        }

        .pagination button.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                margin-top: 10px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .hero h1 {
                font-size: 2.2rem;
            }
            
            .movie-details {
                flex-direction: column;
            }
            
            .movie-details-poster {
                flex: 0 0 auto;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-avatar {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            
            .footer-content {
                flex-direction: column;
            }
            
            .filter-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-group {
                min-width: 100%;
            }

            .admin-tabs {
                flex-wrap: wrap;
            }

            .admin-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" id="home-logo">
                    <i class="fas fa-film"></i>
                    <span>CineVerse</span>
                </a>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-page="home"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#" class="nav-link" data-page="movies"><i class="fas fa-video"></i> Movies</a></li>
                        <li><a href="#" class="nav-link" data-page="tv-shows"><i class="fas fa-tv"></i> TV Shows</a></li>
                        <li><a href="#" class="nav-link" data-page="people"><i class="fas fa-users"></i> People</a></li>
                        <li id="admin-nav"><a href="#" class="nav-link" data-page="admin"><i class="fas fa-cog"></i> Admin</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="btn btn-outline" id="loginBtn"><i class="fas fa-sign-in-alt"></i> Login</button>
                    <button class="btn btn-primary" id="registerBtn"><i class="fas fa-user-plus"></i> Register</button>
                    <div id="userMenu">
                        <button class="btn btn-outline" id="profileBtn"><i class="fas fa-user"></i> Profile</button>
                        <button class="btn btn-outline" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content">
        <!-- Home Page -->
        <section id="home-page" class="page active">
            <div class="hero">
                <div class="container">
                    <h1>Welcome to CineVerse</h1>
                    <p>Discover movies, TV shows, and celebrities. Track what you watch and never forget a movie again.</p>
                    <div class="search-container">
                        <div class="search-box">
                            <input type="text" id="search-input" placeholder="Search for movies, TV shows, people...">
                            <button id="search-btn" aria-label="Search"><i class="fas fa-search"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container">
                <!-- Filters -->
                <div class="filters">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label for="genre-filter">Genre</label>
                            <select id="genre-filter" class="filter-select">
                                <option value="all">All Genres</option>
                                <option value="action">Action</option>
                                <option value="comedy">Comedy</option>
                                <option value="drama">Drama</option>
                                <option value="horror">Horror</option>
                                <option value="sci-fi">Sci-Fi</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="year-filter">Year</label>
                            <select id="year-filter" class="filter-select">
                                <option value="all">All Years</option>
                                <option value="2023">2023</option>
                                <option value="2022">2022</option>
                                <option value="2021">2021</option>
                                <option value="2020">2020</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="rating-filter">Rating</label>
                            <select id="rating-filter" class="filter-select">
                                <option value="all">All Ratings</option>
                                <option value="9">9+</option>
                                <option value="8">8+</option>
                                <option value="7">7+</option>
                                <option value="6">6+</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="sort-filter">Sort By</label>
                            <select id="sort-filter" class="filter-select">
                                <option value="popularity">Popularity</option>
                                <option value="rating">Rating</option>
                                <option value="year">Year</option>
                                <option value="title">Title</option>
                            </select>
                        </div>
                        <div class="filter-group align-end">
                            <button class="btn btn-primary" id="apply-filters"><i class="fas fa-filter"></i> Apply</button>
                            <button class="btn btn-outline" id="reset-filters"><i class="fas fa-redo"></i> Reset</button>
                        </div>
                    </div>
                </div>

                <div class="section-title">
                    <span>Trending Movies</span>
                    <div class="view-options">
                        <button class="view-option active" data-view="grid" aria-label="Grid view"><i class="fas fa-th"></i></button>
                        <button class="view-option" data-view="list" aria-label="List view"><i class="fas fa-list"></i></button>
                    </div>
                </div>
                <div class="movies-grid" id="trending-movies">
                    <!-- Trending movies will be loaded here -->
                </div>

                <div class="section-title">
                    <span>Popular Movies</span>
                </div>
                <div class="movies-grid" id="popular-movies">
                    <!-- Popular movies will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Movies Page -->
        <section id="movies-page" class="page">
            <div class="container">
                <h1 class="section-title">All Movies</h1>
                <div class="movies-grid" id="all-movies">
                    <!-- All movies will be loaded here -->
                </div>
                <div class="pagination" id="movies-pagination">
                    <!-- Pagination will be added here -->
                </div>
            </div>
        </section>

        <!-- Movie Details Page -->
        <section id="movie-details-page" class="page">
            <div class="container">
                <div id="movie-details-content">
                    <!-- Movie details will be loaded here -->
                </div>
            </div>
        </section>

        <!-- User Profile Page -->
        <section id="profile-page" class="page">
            <div class="container">
                <div class="profile-header">
                    <div class="profile-avatar" id="profile-avatar">U</div>
                    <div class="profile-info">
                        <h1 id="profile-username">Username</h1>
                        <p id="profile-email">user@example.com</p>
                        <div class="stats">
                            <div class="stat">
                                <div class="stat-value" id="watchlist-count">0</div>
                                <div class="stat-label">Watchlist</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="ratings-count">0</div>
                                <div class="stat-label">Ratings</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="reviews-count">0</div>
                                <div class="stat-label">Reviews</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-title">My Watchlist</div>
                <div class="movies-grid" id="user-watchlist">
                    <!-- User's watchlist will be loaded here -->
                </div>

                <div class="section-title">My Ratings</div>
                <div id="user-ratings">
                    <!-- User's ratings will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Admin Panel Page -->
        <section id="admin-page" class="page">
            <div class="container">
                <h1 class="section-title">Admin Panel</h1>
                
                <div class="admin-panel">
                    <div class="admin-tabs">
                        <button class="admin-tab active" data-tab="movies-management">Movies Management</button>
                        <button class="admin-tab" data-tab="users-management">Users Management</button>
                        <button class="admin-tab" data-tab="add-movie">Add New Movie</button>
                    </div>

                    <!-- Movies Management Tab -->
                    <div class="admin-content active" id="movies-management">
                        <h2>Movies Management</h2>
                        <p>Manage all movies in the database. You can edit, delete, or change publication status.</p>
                        
                        <div class="search-container admin-search">
                            <div class="search-box">
                                <input type="text" id="admin-movie-search" placeholder="Search movies...">
                                <button id="admin-movie-search-btn" aria-label="Search movies"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                        
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Year</th>
                                    <th>Rating</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-movies-table">
                                <!-- Movies will be populated here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Users Management Tab -->
                    <div class="admin-content" id="users-management">
                        <h2>Users Management</h2>
                        <p>Manage all users in the system. You can change user roles or delete accounts.</p>
                        
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Join Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-users-table">
                                <!-- Users will be populated here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Add Movie Tab -->
                    <div class="admin-content" id="add-movie">
                        <h2>Add New Movie</h2>
                        <p>Add a new movie to the database. Fill in all required details.</p>
                        
                        <form id="add-movie-form">
                            <div class="form-group">
                                <label for="movie-title">Movie Title</label>
                                <input type="text" id="movie-title" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-year">Release Year</label>
                                <input type="number" id="movie-year" class="form-control" min="1900" max="2030" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-rating">Rating (0-10)</label>
                                <input type="number" id="movie-rating" class="form-control" min="0" max="10" step="0.1" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-poster">Poster URL</label>
                                <input type="url" id="movie-poster" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-overview">Overview</label>
                                <textarea id="movie-overview" class="form-control" required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-genres">Genres (comma separated)</label>
                                <input type="text" id="movie-genres" class="form-control" placeholder="Action, Drama, Sci-Fi" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-duration">Duration</label>
                                <input type="text" id="movie-duration" class="form-control" placeholder="142 min" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-director">Director</label>
                                <input type="text" id="movie-director" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-cast">Cast (comma separated)</label>
                                <input type="text" id="movie-cast" class="form-control" placeholder="Actor 1, Actor 2, Actor 3" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="movie-popularity">Popularity (0-100)</label>
                                <input type="number" id="movie-popularity" class="form-control" min="0" max="100" required>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Movie
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>CineVerse</h3>
                    <p>The movie database you can build yourself. Track, rate, and discover films.</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-info-circle"></i> About Us</a></li>
                        <li><a href="#"><i class="fas fa-envelope"></i> Contact</a></li>
                        <li><a href="#"><i class="fas fa-code"></i> API</a></li>
                        <li><a href="#"><i class="fas fa-question-circle"></i> Support</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Legal</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-gavel"></i> Terms of Use</a></li>
                        <li><a href="#"><i class="fas fa-shield-alt"></i> Privacy Policy</a></li>
                        <li><a href="#"><i class="fas fa-cookie-bite"></i> Cookie Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 CineVerse. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login to CineVerse</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary full-width">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </form>
                <p class="center-text mt-15">
                    Don't have an account? <a href="#" id="show-register">Register</a>
                </p>
                <div class="admin-hint">
                    <p><strong>Admin Login:</strong> admin@cineverse.com / admin123</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Join CineVerse</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="register-form">
                    <div class="form-group">
                        <label for="register-username">Username</label>
                        <input type="text" id="register-username" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="register-confirm-password">Confirm Password</label>
                        <input type="password" id="register-confirm-password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary full-width">
                        <i class="fas fa-user-plus"></i> Register
                    </button>
                </form>
                <p class="center-text mt-15">
                    Already have an account? <a href="#" id="show-login">Login</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Enhanced movie data with more details
        let movies = [
            {
                id: 1,
                title: "The Shawshank Redemption",
                year: 1994,
                rating: 9.3,
                poster: "https://source.unsplash.com/random/300x450/?prison",
                overview: "Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.",
                genres: ["Drama"],
                duration: "142 min",
                director: "Frank Darabont",
                cast: ["Tim Robbins", "Morgan Freeman", "Bob Gunton"],
                popularity: 95,
                status: "published"
            },
            {
                id: 2,
                title: "The Godfather",
                year: 1972,
                rating: 9.2,
                poster: "https://source.unsplash.com/random/300x450/?mafia",
                overview: "The aging patriarch of an organized crime dynasty transfers control of his clandestine empire to his reluctant son.",
                genres: ["Crime", "Drama"],
                duration: "175 min",
                director: "Francis Ford Coppola",
                cast: ["Marlon Brando", "Al Pacino", "James Caan"],
                popularity: 92,
                status: "published"
            },
            {
                id: 3,
                title: "The Dark Knight",
                year: 2008,
                rating: 9.0,
                poster: "https://source.unsplash.com/random/300x450/?batman",
                overview: "When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.",
                genres: ["Action", "Crime", "Drama"],
                duration: "152 min",
                director: "Christopher Nolan",
                cast: ["Christian Bale", "Heath Ledger", "Aaron Eckhart"],
                popularity: 90,
                status: "published"
            },
            {
                id: 4,
                title: "Pulp Fiction",
                year: 1994,
                rating: 8.9,
                poster: "https://source.unsplash.com/random/300x450/?gangster",
                overview: "The lives of two mob hitmen, a boxer, a gangster and his wife, and a pair of diner bandits intertwine in four tales of violence and redemption.",
                genres: ["Crime", "Drama"],
                duration: "154 min",
                director: "Quentin Tarantino",
                cast: ["John Travolta", "Uma Thurman", "Samuel L. Jackson"],
                popularity: 88,
                status: "published"
            },
            {
                id: 5,
                title: "Forrest Gump",
                year: 1994,
                rating: 8.8,
                poster: "https://source.unsplash.com/random/300x450/?running",
                overview: "The presidencies of Kennedy and Johnson, the Vietnam War, the Watergate scandal and other historical events unfold from the perspective of an Alabama man with an IQ of 75, whose only desire is to be reunited with his childhood sweetheart.",
                genres: ["Drama", "Romance"],
                duration: "142 min",
                director: "Robert Zemeckis",
                cast: ["Tom Hanks", "Robin Wright", "Gary Sinise"],
                popularity: 85,
                status: "published"
            },
            {
                id: 6,
                title: "Inception",
                year: 2010,
                rating: 8.8,
                poster: "https://source.unsplash.com/random/300x450/?dream",
                overview: "A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea into the mind of a C.E.O.",
                genres: ["Action", "Adventure", "Sci-Fi"],
                duration: "148 min",
                director: "Christopher Nolan",
                cast: ["Leonardo DiCaprio", "Joseph Gordon-Levitt", "Ellen Page"],
                popularity: 87,
                status: "published"
            },
            {
                id: 7,
                title: "The Matrix",
                year: 1999,
                rating: 8.7,
                poster: "https://source.unsplash.com/random/300x450/?code",
                overview: "A computer hacker learns from mysterious rebels about the true nature of his reality and his role in the war against its controllers.",
                genres: ["Action", "Sci-Fi"],
                duration: "136 min",
                director: "Lana Wachowski, Lilly Wachowski",
                cast: ["Keanu Reeves", "Laurence Fishburne", "Carrie-Anne Moss"],
                popularity: 84,
                status: "published"
            },
            {
                id: 8,
                title: "Goodfellas",
                year: 1990,
                rating: 8.7,
                poster: "https://source.unsplash.com/random/300x450/?gangster,1990",
                overview: "The story of Henry Hill and his life in the mob, covering his relationship with his wife Karen Hill and his mob partners Jimmy Conway and Tommy DeVito in the Italian-American crime syndicate.",
                genres: ["Biography", "Crime", "Drama"],
                duration: "146 min",
                director: "Martin Scorsese",
                cast: ["Robert De Niro", "Ray Liotta", "Joe Pesci"],
                popularity: 82,
                status: "published"
            },
            {
                id: 9,
                title: "The Lord of the Rings: The Return of the King",
                year: 2003,
                rating: 8.9,
                poster: "https://source.unsplash.com/random/300x450/?fantasy",
                overview: "Gandalf and Aragorn lead the World of Men against Sauron's army to draw his gaze from Frodo and Sam as they approach Mount Doom with the One Ring.",
                genres: ["Adventure", "Drama", "Fantasy"],
                duration: "201 min",
                director: "Peter Jackson",
                cast: ["Elijah Wood", "Viggo Mortensen", "Ian McKellen"],
                popularity: 89,
                status: "published"
            },
            {
                id: 10,
                title: "Fight Club",
                year: 1999,
                rating: 8.8,
                poster: "https://source.unsplash.com/random/300x450/?fight",
                overview: "An insomniac office worker and a devil-may-care soapmaker form an underground fight club that evolves into something much, much more.",
                genres: ["Drama"],
                duration: "139 min",
                director: "David Fincher",
                cast: ["Brad Pitt", "Edward Norton", "Helena Bonham Carter"],
                popularity: 86,
                status: "published"
            }
        ];

        // Default admin user
        const defaultAdmin = {
            id: 0,
            username: "admin",
            email: "admin@cineverse.com",
            password: "admin123",
            role: "admin",
            joinDate: new Date().toISOString()
        };

        // User management
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('users')) || [defaultAdmin];
        let watchlist = JSON.parse(localStorage.getItem('watchlist')) || {};
        let ratings = JSON.parse(localStorage.getItem('ratings')) || {};
        let reviews = JSON.parse(localStorage.getItem('reviews')) || {};

        // App state
        let currentView = 'grid';
        let currentFilters = {
            genre: 'all',
            year: 'all',
            rating: 'all',
            sort: 'popularity'
        };
        let currentPage = 1;
        const moviesPerPage = 8;

        // DOM Elements
        const pages = document.querySelectorAll('.page');
        const navLinks = document.querySelectorAll('.nav-link');
        const loginBtn = document.getElementById('loginBtn');
        const registerBtn = document.getElementById('registerBtn');
        const profileBtn = document.getElementById('profileBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const userMenu = document.getElementById('userMenu');
        const adminNav = document.getElementById('admin-nav');
        const loginModal = document.getElementById('login-modal');
        const registerModal = document.getElementById('register-modal');
        const closeBtns = document.querySelectorAll('.close-btn');
        const showRegister = document.getElementById('show-register');
        const showLogin = document.getElementById('show-login');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const themeToggle = document.getElementById('themeToggle');
        const viewOptions = document.querySelectorAll('.view-option');
        const genreFilter = document.getElementById('genre-filter');
        const yearFilter = document.getElementById('year-filter');
        const ratingFilter = document.getElementById('rating-filter');
        const sortFilter = document.getElementById('sort-filter');
        const applyFiltersBtn = document.getElementById('apply-filters');
        const resetFiltersBtn = document.getElementById('reset-filters');
        const toast = document.getElementById('toast');
        const homeLogo = document.getElementById('home-logo');
        const adminTabs = document.querySelectorAll('.admin-tab');
        const adminContents = document.querySelectorAll('.admin-content');
        const adminMoviesTable = document.getElementById('admin-movies-table');
        const adminUsersTable = document.getElementById('admin-users-table');
        const addMovieForm = document.getElementById('add-movie-form');
        const adminMovieSearch = document.getElementById('admin-movie-search');
        const adminMovieSearchBtn = document.getElementById('admin-movie-search-btn');

        // Initialize the app
        function initApp() {
            // Check if user is logged in
            const loggedInUser = localStorage.getItem('currentUser');
            if (loggedInUser) {
                currentUser = JSON.parse(loggedInUser);
                updateUIForUser();
            }
            
            // Check for saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            // Load movies
            loadTrendingMovies();
            loadPopularMovies();
            loadAllMovies();
            
            // Set up event listeners
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Navigation
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = e.target.getAttribute('data-page');
                    showPage(page);
                });
            });

            // Home logo
            homeLogo.addEventListener('click', (e) => {
                e.preventDefault();
                showPage('home');
            });

            // Auth buttons
            loginBtn.addEventListener('click', () => showModal('login-modal'));
            registerBtn.addEventListener('click', () => showModal('register-modal'));
            profileBtn.addEventListener('click', () => showPage('profile'));
            logoutBtn.addEventListener('click', logout);

            // Modal controls
            closeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    loginModal.style.display = 'none';
                    registerModal.style.display = 'none';
                });
            });

            showRegister.addEventListener('click', (e) => {
                e.preventDefault();
                loginModal.style.display = 'none';
                registerModal.style.display = 'block';
            });

            showLogin.addEventListener('click', (e) => {
                e.preventDefault();
                registerModal.style.display = 'none';
                loginModal.style.display = 'block';
            });

            // Forms
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            addMovieForm.addEventListener('submit', handleAddMovie);

            // Search
            searchBtn.addEventListener('click', handleSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSearch();
                }
            });

            // Admin search
            adminMovieSearchBtn.addEventListener('click', handleAdminMovieSearch);
            adminMovieSearch.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleAdminMovieSearch();
                }
            });

            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);

            // View options
            viewOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    const view = e.currentTarget.getAttribute('data-view');
                    setView(view);
                });
            });

            // Filters
            applyFiltersBtn.addEventListener('click', applyFilters);
            resetFiltersBtn.addEventListener('click', resetFilters);

            // Admin tabs
            adminTabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const tabId = e.currentTarget.getAttribute('data-tab');
                    switchAdminTab(tabId);
                });
            });

            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
                if (e.target === registerModal) {
                    registerModal.style.display = 'none';
                }
            });
        }

        // Show specific page
        function showPage(pageName) {
            pages.forEach(page => {
                page.classList.remove('active');
            });

            // Update active nav link
            navLinks.forEach(link => {
                if (link.getAttribute('data-page') === pageName) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            if (pageName === 'home') {
                document.getElementById('home-page').classList.add('active');
            } else if (pageName === 'movies') {
                document.getElementById('movies-page').classList.add('active');
                loadAllMovies();
            } else if (pageName === 'profile') {
                if (currentUser) {
                    document.getElementById('profile-page').classList.add('active');
                    loadUserProfile();
                } else {
                    showModal('login-modal');
                }
            } else if (pageName === 'admin') {
                if (currentUser && currentUser.role === 'admin') {
                    document.getElementById('admin-page').classList.add('active');
                    loadAdminPanel();
                } else {
                    showToast('Access denied. Admin privileges required.', 'error');
                    showPage('home');
                }
            }
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                updateUIForUser();
                loginModal.style.display = 'none';
                loginForm.reset();
                showToast('Login successful!', 'success');
            } else {
                showToast('Invalid email or password', 'error');
            }
        }

        // Handle registration
        function handleRegister(e) {
            e.preventDefault();
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm-password').value;

            if (password !== confirmPassword) {
                showToast('Passwords do not match', 'error');
                return;
            }

            if (users.find(u => u.email === email)) {
                showToast('User with this email already exists', 'error');
                return;
            }

            const newUser = {
                id: Date.now(),
                username,
                email,
                password,
                role: 'user',
                joinDate: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Initialize user's data
            watchlist[newUser.id] = [];
            ratings[newUser.id] = [];
            reviews[newUser.id] = [];
            localStorage.setItem('watchlist', JSON.stringify(watchlist));
            localStorage.setItem('ratings', JSON.stringify(ratings));
            localStorage.setItem('reviews', JSON.stringify(reviews));

            registerModal.style.display = 'none';
            registerForm.reset();
            showToast('Registration successful! Please login.', 'success');
            showModal('login-modal');
        }

        // Logout
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUIForUser();
            showPage('home');
            showToast('You have been logged out', 'warning');
        }

        // Update UI based on user login status
        function updateUIForUser() {
            if (currentUser) {
                loginBtn.style.display = 'none';
                registerBtn.style.display = 'none';
                userMenu.style.display = 'flex';
                
                // Show admin nav if user is admin
                if (currentUser.role === 'admin') {
                    adminNav.style.display = 'block';
                } else {
                    adminNav.style.display = 'none';
                }
            } else {
                loginBtn.style.display = 'block';
                registerBtn.style.display = 'block';
                userMenu.style.display = 'none';
                adminNav.style.display = 'none';
            }
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('theme', 'dark');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                localStorage.setItem('theme', 'light');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }

        // Switch admin tab
        function switchAdminTab(tabId) {
            adminTabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            adminContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        // Load admin panel
        function loadAdminPanel() {
            loadAdminMoviesTable();
            loadAdminUsersTable();
        }

        // Load admin movies table
        function loadAdminMoviesTable() {
            if (!adminMoviesTable) return;
            
            adminMoviesTable.innerHTML = '';
            
            if (movies.length === 0) {
                adminMoviesTable.innerHTML = '<tr><td colspan="5" style="text-align: center;">No movies found</td></tr>';
                return;
            }
            
            movies.forEach(movie => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${movie.title}</td>
                    <td>${movie.year}</td>
                    <td>${movie.rating}</td>
                    <td><span class="status-badge ${movie.status === 'published' ? 'status-published' : 'status-draft'}">${movie.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-primary edit-movie" data-movie-id="${movie.id}">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-sm ${movie.status === 'published' ? 'btn-warning' : 'btn-success'} toggle-movie" data-movie-id="${movie.id}">
                            <i class="fas ${movie.status === 'published' ? 'fa-eye-slash' : 'fa-eye'}"></i> ${movie.status === 'published' ? 'Unpublish' : 'Publish'}
                        </button>
                        <button class="btn btn-sm btn-danger delete-movie" data-movie-id="${movie.id}">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                
                adminMoviesTable.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.edit-movie').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const movieId = e.currentTarget.getAttribute('data-movie-id');
                    editMovie(movieId);
                });
            });
            
            document.querySelectorAll('.toggle-movie').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const movieId = e.currentTarget.getAttribute('data-movie-id');
                    toggleMovieStatus(movieId);
                });
            });
            
            document.querySelectorAll('.delete-movie').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const movieId = e.currentTarget.getAttribute('data-movie-id');
                    deleteMovie(movieId);
                });
            });
        }

        // Load admin users table
        function loadAdminUsersTable() {
            if (!adminUsersTable) return;
            
            adminUsersTable.innerHTML = '';
            
            if (users.length === 0) {
                adminUsersTable.innerHTML = '<tr><td colspan="5" style="text-align: center;">No users found</td></tr>';
                return;
            }
            
            users.forEach(user => {
                // Don't show the current admin user in the list
                if (user.id === currentUser.id) return;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.email}</td>
                    <td><span class="role-badge ${user.role === 'admin' ? 'role-admin' : 'role-user'}">${user.role}</span></td>
                    <td>${new Date(user.joinDate).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-sm ${user.role === 'admin' ? 'btn-warning' : 'btn-success'} toggle-role" data-user-id="${user.id}">
                            <i class="fas fa-user-${user.role === 'admin' ? 'shield' : 'cog'}"></i> Make ${user.role === 'admin' ? 'User' : 'Admin'}
                        </button>
                        <button class="btn btn-sm btn-danger delete-user" data-user-id="${user.id}">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                
                adminUsersTable.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.toggle-role').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = e.currentTarget.getAttribute('data-user-id');
                    toggleUserRole(userId);
                });
            });
            
            document.querySelectorAll('.delete-user').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const userId = e.currentTarget.getAttribute('data-user-id');
                    deleteUser(userId);
                });
            });
        }

        // Handle add movie form
        function handleAddMovie(e) {
            e.preventDefault();
            
            const title = document.getElementById('movie-title').value;
            const year = parseInt(document.getElementById('movie-year').value);
            const rating = parseFloat(document.getElementById('movie-rating').value);
            const poster = document.getElementById('movie-poster').value;
            const overview = document.getElementById('movie-overview').value;
            const genres = document.getElementById('movie-genres').value.split(',').map(g => g.trim());
            const duration = document.getElementById('movie-duration').value;
            const director = document.getElementById('movie-director').value;
            const cast = document.getElementById('movie-cast').value.split(',').map(c => c.trim());
            const popularity = parseInt(document.getElementById('movie-popularity').value);
            
            const newMovie = {
                id: Date.now(),
                title,
                year,
                rating,
                poster,
                overview,
                genres,
                duration,
                director,
                cast,
                popularity,
                status: 'published'
            };
            
            movies.push(newMovie);
            localStorage.setItem('movies', JSON.stringify(movies));
            
            addMovieForm.reset();
            showToast('Movie added successfully!', 'success');
            loadAdminMoviesTable();
            
            // Reload movie displays
            loadTrendingMovies();
            loadPopularMovies();
            loadAllMovies();
        }

        // Edit movie (placeholder function)
        function editMovie(movieId) {
            showToast('Edit movie functionality would open a form with pre-filled data', 'warning');
        }

        // Toggle movie status
        function toggleMovieStatus(movieId) {
            const movie = movies.find(m => m.id == movieId);
            if (!movie) return;
            
            movie.status = movie.status === 'published' ? 'draft' : 'published';
            localStorage.setItem('movies', JSON.stringify(movies));
            
            showToast(`Movie ${movie.status === 'published' ? 'published' : 'unpublished'} successfully!`, 'success');
            loadAdminMoviesTable();
            
            // Reload movie displays
            loadTrendingMovies();
            loadPopularMovies();
            loadAllMovies();
        }

        // Delete movie
        function deleteMovie(movieId) {
            if (!confirm('Are you sure you want to delete this movie? This action cannot be undone.')) {
                return;
            }
            
            movies = movies.filter(m => m.id != movieId);
            localStorage.setItem('movies', JSON.stringify(movies));
            
            showToast('Movie deleted successfully!', 'success');
            loadAdminMoviesTable();
            
            // Reload movie displays
            loadTrendingMovies();
            loadPopularMovies();
            loadAllMovies();
        }

        // Toggle user role
        function toggleUserRole(userId) {
            const user = users.find(u => u.id == userId);
            if (!user) return;
            
            user.role = user.role === 'admin' ? 'user' : 'admin';
            localStorage.setItem('users', JSON.stringify(users));
            
            showToast(`User role changed to ${user.role} successfully!`, 'success');
            loadAdminUsersTable();
        }

        // Delete user
        function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                return;
            }
            
            users = users.filter(u => u.id != userId);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Also remove user's data
            delete watchlist[userId];
            delete ratings[userId];
            delete reviews[userId];
            localStorage.setItem('watchlist', JSON.stringify(watchlist));
            localStorage.setItem('ratings', JSON.stringify(ratings));
            localStorage.setItem('reviews', JSON.stringify(reviews));
            
            showToast('User deleted successfully!', 'success');
            loadAdminUsersTable();
        }

        // Handle admin movie search
        function handleAdminMovieSearch() {
            const query = adminMovieSearch.value.toLowerCase().trim();
            if (!query) {
                loadAdminMoviesTable();
                return;
            }
            
            const filteredMovies = movies.filter(movie => 
                movie.title.toLowerCase().includes(query)
            );
            
            adminMoviesTable.innerHTML = '';
            
            if (filteredMovies.length === 0) {
                adminMoviesTable.innerHTML = '<tr><td colspan="5" style="text-align: center;">No movies found</td></tr>';
                return;
            }
            
            filteredMovies.forEach(movie => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${movie.title}</td>
                    <td>${movie.year}</td>
                    <td>${movie.rating}</td>
                    <td><span class="status-badge ${movie.status === 'published' ? 'status-published' : 'status-draft'}">${movie.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-primary edit-movie" data-movie-id="${movie.id}">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-sm ${movie.status === 'published' ? 'btn-warning' : 'btn-success'} toggle-movie" data-movie-id="${movie.id}">
                            <i class="fas ${movie.status === 'published' ? 'fa-eye-slash' : 'fa-eye'}"></i> ${movie.status === 'published' ? 'Unpublish' : 'Publish'}
                        </button>
                        <button class="btn btn-sm btn-danger delete-movie" data-movie-id="${movie.id}">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                
                adminMoviesTable.appendChild(row);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.edit-movie').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const movieId = e.currentTarget.getAttribute('data-movie-id');
                    editMovie(movieId);
                });
            });
            
            document.querySelectorAll('.toggle-movie').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const movieId = e.currentTarget.getAttribute('data-movie-id');
                    toggleMovieStatus(movieId);
                });
            });
            
            document.querySelectorAll('.delete-movie').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const movieId = e.currentTarget.getAttribute('data-movie-id');
                    deleteMovie(movieId);
                });
            });
        }

        // Set view (grid or list)
        function setView(view) {
            currentView = view;
            
            // Update active view button
            viewOptions.forEach(option => {
                if (option.getAttribute('data-view') === view) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // Update movie containers
            const containers = [
                document.getElementById('trending-movies'),
                document.getElementById('popular-movies'),
                document.getElementById('all-movies'),
                document.getElementById('user-watchlist')
            ];
            
            containers.forEach(container => {
                if (container) {
                    if (view === 'grid') {
                        container.className = 'movies-grid';
                    } else {
                        container.className = 'movies-list';
                    }
                    
                    // Reload content with new view
                    const movieIds = Array.from(container.children).map(el => el.getAttribute('data-movie-id'));
                    container.innerHTML = '';
                    
                    movieIds.forEach(id => {
                        const movie = movies.find(m => m.id == id);
                        if (movie) {
                            const movieElement = createMovieElement(movie, view);
                            container.appendChild(movieElement);
                        }
                    });
                }
            });
        }

        // Apply filters
        function applyFilters() {
            currentFilters.genre = genreFilter.value;
            currentFilters.year = yearFilter.value;
            currentFilters.rating = ratingFilter.value;
            currentFilters.sort = sortFilter.value;
            
            // Filter and sort movies
            let filteredMovies = movies.filter(movie => {
                // Only show published movies to regular users
                if (currentUser?.role !== 'admin' && movie.status !== 'published') {
                    return false;
                }
                
                // Genre filter
                if (currentFilters.genre !== 'all' && !movie.genres.includes(currentFilters.genre)) {
                    return false;
                }
                
                // Year filter
                if (currentFilters.year !== 'all' && movie.year != currentFilters.year) {
                    return false;
                }
                
                // Rating filter
                if (currentFilters.rating !== 'all' && movie.rating < parseFloat(currentFilters.rating)) {
                    return false;
                }
                
                return true;
            });
            
            // Sort movies
            filteredMovies = sortMovies(filteredMovies, currentFilters.sort);
            
            // Update movie displays
            updateMovieDisplay('trending-movies', filteredMovies.slice(0, 6));
            updateMovieDisplay('popular-movies', filteredMovies);
            updateMovieDisplay('all-movies', filteredMovies);
            
            showToast(`Found ${filteredMovies.length} movies`, 'success');
        }

        // Sort movies
        function sortMovies(moviesToSort, sortBy) {
            const sortedMovies = [...moviesToSort];
            
            switch(sortBy) {
                case 'rating':
                    return sortedMovies.sort((a, b) => b.rating - a.rating);
                case 'year':
                    return sortedMovies.sort((a, b) => b.year - a.year);
                case 'title':
                    return sortedMovies.sort((a, b) => a.title.localeCompare(b.title));
                case 'popularity':
                default:
                    return sortedMovies.sort((a, b) => b.popularity - a.popularity);
            }
        }

        // Reset filters
        function resetFilters() {
            genreFilter.value = 'all';
            yearFilter.value = 'all';
            ratingFilter.value = 'all';
            sortFilter.value = 'popularity';
            currentFilters = {
                genre: 'all',
                year: 'all',
                rating: 'all',
                sort: 'popularity'
            };
            
            // Reload all movies
            loadTrendingMovies();
            loadPopularMovies();
            loadAllMovies();
            
            showToast('Filters reset', 'success');
        }

        // Update movie display
        function updateMovieDisplay(containerId, moviesToShow) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = '';
            
            if (moviesToShow.length === 0) {
                container.innerHTML = '<div class="loading">No movies found</div>';
                return;
            }
            
            moviesToShow.forEach(movie => {
                const movieElement = createMovieElement(movie, currentView);
                container.appendChild(movieElement);
            });
        }

        // Load trending movies
        function loadTrendingMovies() {
            const trendingContainer = document.getElementById('trending-movies');
            if (!trendingContainer) return;
            
            // Sort by popularity and get first 6
            const trendingMovies = [...movies]
                .filter(m => m.status === 'published')
                .sort((a, b) => b.popularity - a.popularity)
                .slice(0, 6);
            
            updateMovieDisplay('trending-movies', trendingMovies);
        }

        // Load popular movies
        function loadPopularMovies() {
            const popularContainer = document.getElementById('popular-movies');
            if (!popularContainer) return;
            
            // Sort by rating and get all
            const popularMovies = [...movies]
                .filter(m => m.status === 'published')
                .sort((a, b) => b.rating - a.rating);
            
            updateMovieDisplay('popular-movies', popularMovies);
        }

        // Load all movies with pagination
        function loadAllMovies() {
            const allMoviesContainer = document.getElementById('all-movies');
            if (!allMoviesContainer) return;
            
            // Get filtered and sorted movies
            let filteredMovies = movies.filter(movie => {
                // Only show published movies to regular users
                if (currentUser?.role !== 'admin' && movie.status !== 'published') {
                    return false;
                }
                
                if (currentFilters.genre !== 'all' && !movie.genres.includes(currentFilters.genre)) {
                    return false;
                }
                if (currentFilters.year !== 'all' && movie.year != currentFilters.year) {
                    return false;
                }
                if (currentFilters.rating !== 'all' && movie.rating < parseFloat(currentFilters.rating)) {
                    return false;
                }
                return true;
            });
            
            filteredMovies = sortMovies(filteredMovies, currentFilters.sort);
            
            // Calculate pagination
            const totalPages = Math.ceil(filteredMovies.length / moviesPerPage);
            const startIndex = (currentPage - 1) * moviesPerPage;
            const endIndex = startIndex + moviesPerPage;
            const paginatedMovies = filteredMovies.slice(startIndex, endIndex);
            
            updateMovieDisplay('all-movies', paginatedMovies);
            createPagination(totalPages);
        }

        // Create pagination
        function createPagination(totalPages) {
            const paginationContainer = document.getElementById('movies-pagination');
            if (!paginationContainer) return;
            
            paginationContainer.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Previous button
            const prevButton = document.createElement('button');
            prevButton.innerHTML = '<i class="fas fa-chevron-left"></i>';
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    loadAllMovies();
                }
            });
            paginationContainer.appendChild(prevButton);
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i;
                if (i === currentPage) {
                    pageButton.classList.add('active');
                }
                pageButton.addEventListener('click', () => {
                    currentPage = i;
                    loadAllMovies();
                });
                paginationContainer.appendChild(pageButton);
            }
            
            // Next button
            const nextButton = document.createElement('button');
            nextButton.innerHTML = '<i class="fas fa-chevron-right"></i>';
            nextButton.disabled = currentPage === totalPages;
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    loadAllMovies();
                }
            });
            paginationContainer.appendChild(nextButton);
        }

        // Create movie element based on view
        function createMovieElement(movie, view = 'grid') {
            if (view === 'list') {
                return createMovieListItem(movie);
            } else {
                return createMovieGridItem(movie);
            }
        }

        // Create movie grid item
        function createMovieGridItem(movie) {
            const movieCard = document.createElement('div');
            movieCard.className = 'movie-card';
            movieCard.setAttribute('data-movie-id', movie.id);
            movieCard.addEventListener('click', () => showMovieDetails(movie.id));
            
            const ratingStars = ''.repeat(Math.floor(movie.rating));
            const isInWatchlist = currentUser && isInWatchlist(movie.id);
            
            movieCard.innerHTML = `
                <img src="${movie.poster}" alt="${movie.title}" class="movie-poster">
                <div class="movie-info">
                    <div class="movie-title">${movie.title}</div>
                    <div class="movie-meta">
                        <div class="movie-year">${movie.year}</div>
                        <div class="movie-rating">
                            <span class="rating-stars">${ratingStars}</span>
                            <span>${movie.rating}</span>
                        </div>
                    </div>
                    <div class="movie-actions">
                        <button class="action-btn watchlist ${isInWatchlist ? 'active' : ''}" data-movie-id="${movie.id}">
                            <i class="fas ${isInWatchlist ? 'fa-check' : 'fa-plus'}"></i>
                            Watchlist
                        </button>
                        <button class="action-btn like" data-movie-id="${movie.id}">
                            <i class="far fa-heart"></i>
                        </button>
                    </div>
                </div>
            `;
            
            // Add event listeners for action buttons
            const watchlistBtn = movieCard.querySelector('.watchlist');
            watchlistBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleWatchlist(movie.id);
            });
            
            const likeBtn = movieCard.querySelector('.like');
            likeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleLike(movie.id);
            });
            
            return movieCard;
        }

        // Create movie list item
        function createMovieListItem(movie) {
            const movieItem = document.createElement('div');
            movieItem.className = 'movie-item';
            movieItem.setAttribute('data-movie-id', movie.id);
            movieItem.addEventListener('click', () => showMovieDetails(movie.id));
            
            const ratingStars = ''.repeat(Math.floor(movie.rating));
            const isInWatchlist = currentUser && isInWatchlist(movie.id);
            
            movieItem.innerHTML = `
                <img src="${movie.poster}" alt="${movie.title}" class="movie-item-poster">
                <div class="movie-item-info">
                    <div class="movie-item-header">
                        <div class="movie-item-title">${movie.title} (${movie.year})</div>
                        <div class="movie-rating">
                            <span class="rating-stars">${ratingStars}</span>
                            <span>${movie.rating}</span>
                        </div>
                    </div>
                    <div class="movie-item-overview">${movie.overview}</div>
                    <div class="movie-item-footer">
                        <div class="movie-genres">${movie.genres.join(', ')}</div>
                        <div class="movie-item-actions">
                            <button class="action-btn watchlist ${isInWatchlist ? 'active' : ''}" data-movie-id="${movie.id}">
                                <i class="fas ${isInWatchlist ? 'fa-check' : 'fa-plus'}"></i>
                            </button>
                            <button class="action-btn like" data-movie-id="${movie.id}">
                                <i class="far fa-heart"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add event listeners for action buttons
            const watchlistBtn = movieItem.querySelector('.watchlist');
            watchlistBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleWatchlist(movie.id);
            });
            
            const likeBtn = movieItem.querySelector('.like');
            likeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleLike(movie.id);
            });
            
            return movieItem;
        }

        // Show movie details
        function showMovieDetails(movieId) {
            const movie = movies.find(m => m.id === movieId);
            if (!movie) return;
            
            const detailsContainer = document.getElementById('movie-details-content');
            const ratingStars = ''.repeat(Math.floor(movie.rating));
            const isInWatchlist = currentUser && isInWatchlist(movie.id);
            
            detailsContainer.innerHTML = `
                <div class="movie-details">
                    <div class="movie-details-poster">
                        <img src="${movie.poster}" alt="${movie.title}">
                    </div>
                    <div class="movie-details-info">
                        <h1 class="movie-details-title">${movie.title}</h1>
                        <div class="movie-meta">
                            <div class="movie-meta-item">${movie.year}</div>
                            <div class="movie-meta-item">${movie.duration}</div>
                            <div class="movie-meta-item">${movie.genres.join(', ')}</div>
                            <div class="movie-meta-item">
                                <span class="rating-stars">${ratingStars}</span>
                                ${movie.rating}/10
                            </div>
                        </div>
                        <p class="movie-overview">${movie.overview}</p>
                        <div class="movie-meta-item"><strong>Director:</strong> ${movie.director}</div>
                        <div class="movie-meta-item"><strong>Cast:</strong> ${movie.cast.join(', ')}</div>
                        <div class="action-buttons">
                            ${currentUser ? `
                                <button class="btn ${isInWatchlist ? 'btn-secondary' : 'btn-primary'}" id="add-to-watchlist" data-movie-id="${movie.id}">
                                    <i class="fas ${isInWatchlist ? 'fa-check' : 'fa-plus'}"></i>
                                    ${isInWatchlist ? 'In Watchlist' : 'Add to Watchlist'}
                                </button>
                                <button class="btn btn-outline" id="rate-movie" data-movie-id="${movie.id}">
                                    <i class="fas fa-star"></i> Rate Movie
                                </button>
                            ` : `
                                <button class="btn btn-primary" onclick="showModal('login-modal')">
                                    <i class="fas fa-sign-in-alt"></i> Login to Add to Watchlist
                                </button>
                            `}
                        </div>
                    </div>
                </div>
            `;
            
            // Add event listeners for action buttons
            if (currentUser) {
                const addToWatchlistBtn = document.getElementById('add-to-watchlist');
                addToWatchlistBtn.addEventListener('click', () => toggleWatchlist(movie.id));
                
                const rateMovieBtn = document.getElementById('rate-movie');
                rateMovieBtn.addEventListener('click', () => rateMovie(movie.id));
            }
            
            // Show the movie details page
            document.getElementById('movie-details-page').classList.add('active');
            pages.forEach(page => {
                if (page.id !== 'movie-details-page') {
                    page.classList.remove('active');
                }
            });
        }

        // Check if movie is in user's watchlist
        function isInWatchlist(movieId) {
            if (!currentUser) return false;
            return watchlist[currentUser.id] && watchlist[currentUser.id].includes(movieId);
        }

        // Toggle movie in watchlist
        function toggleWatchlist(movieId) {
            if (!currentUser) {
                showModal('login-modal');
                return;
            }
            
            const userWatchlist = watchlist[currentUser.id] || [];
            const index = userWatchlist.indexOf(movieId);
            
            if (index === -1) {
                userWatchlist.push(movieId);
                showToast('Added to watchlist!', 'success');
            } else {
                userWatchlist.splice(index, 1);
                showToast('Removed from watchlist!', 'warning');
            }
            
            watchlist[currentUser.id] = userWatchlist;
            localStorage.setItem('watchlist', JSON.stringify(watchlist));
            
            // Update UI
            const watchlistBtn = document.querySelector(`.watchlist[data-movie-id="${movieId}"]`);
            if (watchlistBtn) {
                if (index === -1) {
                    watchlistBtn.classList.add('active');
                    watchlistBtn.innerHTML = '<i class="fas fa-check"></i> Watchlist';
                } else {
                    watchlistBtn.classList.remove('active');
                    watchlistBtn.innerHTML = '<i class="fas fa-plus"></i> Watchlist';
                }
            }
            
            // Update details page if open
            const detailsWatchlistBtn = document.getElementById('add-to-watchlist');
            if (detailsWatchlistBtn) {
                if (index === -1) {
                    detailsWatchlistBtn.className = 'btn btn-secondary';
                    detailsWatchlistBtn.innerHTML = '<i class="fas fa-check"></i> In Watchlist';
                } else {
                    detailsWatchlistBtn.className = 'btn btn-primary';
                    detailsWatchlistBtn.innerHTML = '<i class="fas fa-plus"></i> Add to Watchlist';
                }
            }
            
            // Refresh profile page if active
            if (document.getElementById('profile-page').classList.contains('active')) {
                loadUserProfile();
            }
        }

        // Toggle like (placeholder function)
        function toggleLike(movieId) {
            if (!currentUser) {
                showModal('login-modal');
                return;
            }
            showToast('Added to favorites!', 'success');
        }

        // Rate a movie
        function rateMovie(movieId) {
            if (!currentUser) {
                showModal('login-modal');
                return;
            }
            
            const rating = prompt('Rate this movie from 1 to 10:');
            if (rating && !isNaN(rating) && rating >= 1 && rating <= 10) {
                const userRatings = ratings[currentUser.id] || [];
                
                // Check if user already rated this movie
                const existingRatingIndex = userRatings.findIndex(r => r.movieId === movieId);
                
                if (existingRatingIndex !== -1) {
                    userRatings[existingRatingIndex].rating = parseFloat(rating);
                    showToast(`Rating updated to ${rating}/10!`, 'success');
                } else {
                    userRatings.push({
                        movieId: movieId,
                        rating: parseFloat(rating),
                        date: new Date().toISOString()
                    });
                    showToast(`You rated this movie ${rating}/10!`, 'success');
                }
                
                ratings[currentUser.id] = userRatings;
                localStorage.setItem('ratings', JSON.stringify(ratings));
                
                // Refresh profile page if active
                if (document.getElementById('profile-page').classList.contains('active')) {
                    loadUserProfile();
                }
            } else if (rating !== null) {
                showToast('Please enter a valid rating between 1 and 10', 'error');
            }
        }

        // Load user profile
        function loadUserProfile() {
            if (!currentUser) return;
            
            // Update profile info
            document.getElementById('profile-avatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('profile-username').textContent = currentUser.username;
            document.getElementById('profile-email').textContent = currentUser.email;
            
            // Update stats
            const userWatchlist = watchlist[currentUser.id] || [];
            const userRatings = ratings[currentUser.id] || [];
            const userReviews = reviews[currentUser.id] || [];
            
            document.getElementById('watchlist-count').textContent = userWatchlist.length;
            document.getElementById('ratings-count').textContent = userRatings.length;
            document.getElementById('reviews-count').textContent = userReviews.length;
            
            // Load watchlist
            const watchlistContainer = document.getElementById('user-watchlist');
            if (watchlistContainer) {
                watchlistContainer.innerHTML = '';
                
                if (userWatchlist.length === 0) {
                    watchlistContainer.innerHTML = '<div class="loading">Your watchlist is empty.</div>';
                } else {
                    userWatchlist.forEach(movieId => {
                        const movie = movies.find(m => m.id === movieId);
                        if (movie) {
                            const movieElement = createMovieElement(movie, currentView);
                            watchlistContainer.appendChild(movieElement);
                        }
                    });
                }
            }
            
            // Load ratings
            const ratingsContainer = document.getElementById('user-ratings');
            if (ratingsContainer) {
                ratingsContainer.innerHTML = '';
                
                if (userRatings.length === 0) {
                    ratingsContainer.innerHTML = '<div class="loading">You haven\'t rated any movies yet.</div>';
                } else {
                    userRatings.forEach(rating => {
                        const movie = movies.find(m => m.id === rating.movieId);
                        if (movie) {
                            const ratingElement = document.createElement('div');
                            ratingElement.className = 'movie-item';
                            ratingElement.addEventListener('click', () => showMovieDetails(movie.id));
                            
                            const ratingStars = ''.repeat(Math.floor(rating.rating));
                            
                            ratingElement.innerHTML = `
                                <img src="${movie.poster}" alt="${movie.title}" class="movie-item-poster">
                                <div class="movie-item-info">
                                    <div class="movie-item-header">
                                        <div class="movie-item-title">${movie.title} (${movie.year})</div>
                                        <div class="movie-rating">
                                            <span class="rating-stars">${ratingStars}</span>
                                            <span>${rating.rating}/10</span>
                                        </div>
                                    </div>
                                    <div class="movie-item-overview">${movie.overview}</div>
                                    <div class="movie-item-footer">
                                        <div class="movie-genres">${movie.genres.join(', ')}</div>
                                        <div>Rated on ${new Date(rating.date).toLocaleDateString()}</div>
                                    </div>
                                </div>
                            `;
                            
                            ratingsContainer.appendChild(ratingElement);
                        }
                    });
                }
            }
        }

        // Handle search
        function handleSearch() {
            const query = searchInput.value.toLowerCase().trim();
            if (!query) return;
            
            // Simple search implementation
            const results = movies.filter(movie => 
                (movie.status === 'published' || currentUser?.role === 'admin') &&
                (movie.title.toLowerCase().includes(query) ||
                movie.overview.toLowerCase().includes(query) ||
                movie.genres.some(genre => genre.toLowerCase().includes(query)) ||
                movie.cast.some(actor => actor.toLowerCase().includes(query)))
            );
            
            if (results.length > 0) {
                // Show movies page with search results
                showPage('movies');
                updateMovieDisplay('all-movies', results);
                
                // Update page title
                document.querySelector('#movies-page .section-title').textContent = `Search Results for "${query}" (${results.length} movies)`;
                showToast(`Found ${results.length} movies for "${query}"`, 'success');
            } else {
                showToast('No movies found matching your search.', 'error');
            }
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = 'toast';
            toast.classList.add(type);
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>
</html>